{# Copyright 2011, Tangere Infotech Pvt Ltd [http://tangere.in]                 #}
{#                                                                              #}
{# Licensed under the Apache License, Version 2.0 (the "License");              #}
{# you may not use this file except in compliance with the License.             #}
{# You may obtain a copy of the License at                                      #}
{#                                                                              #}
{#       http://www.apache.org/licenses/LICENSE-2.0                             #}
{#                                                                              #}
{# Unless required by applicable law or agreed to in writing, software          #}
{# distributed under the License is distributed on an "AS IS" BASIS,            #}
{# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.     #}
{# See the License for the specific language governing permissions and          #}
{# limitations under the License.                                               #}

{% extends "basewithmenu.html" %}

{% load complaint_extras %}

{% block extra_heads %}
<link type="text/css" href="/static/jquery/css/jquery.contextMenu.css" rel="stylesheet" media="screen">
{% endblock %}

{% block page_content %}
<div style="text-align:center;">
  <h2>My Issues</h2>
</div>
<div class="pagination">
    <span class="step-links">
        {% if issues.has_previous %}
        <a href="?page={{ issues.previous_page_number }}">&lt;</a>
        {% else %}
        <span style="text-decoration:none">&lt;</span>
        {% endif %}

        <span class="current">
          <form class="inlineform" action="{{ page_url}}" method="GET">
            <input type="text"
                   name="page"
                   value="{{ issues.number }}"
                   style="width:25px; text-align:center;">
            of {{ issues.paginator.num_pages }}
          </form>
        </span>
        {% if issues.has_next %}
        <a href="?page={{ issues.next_page_number }}">&gt;</a>
        {% else %}
        <span style="text-decoration:none">&gt;</span>
        {% endif %}
    </span>
</div>
<table class="tabularlist">
  <tr>
    <th style="width:16%">Complaint #</th>
    <th style="width:12%">Filed On</th>
    <th style="width:42%">Description</th>
    <th style="width:15%;text-align:center;">Status</th>
    <th style="width:15%">Updated On</th>
    <th style="display:none;"/>
    <th style="display:none"/>
  </tr>
  {% for issue in issues.object_list %}
  <tr class="updateMenu">
    <td style="text-align:center;">{{ issue.complaintno }}</td>
    <td style="text-align:center;">{{ issue.logdate|date:'d/M/Y' }}</td>
    <td style="text-align:left;">{{ issue.description }}</td>
    <td style="text-align:center;">{{ issue.curstate.get_value }}</td>
    <td style="text-align:center;">{{ issue.created|date:'f A, d/M/Y' }}</td>
    <td class="track" style="display:none">
      <form method="GET" action="/complaint/track/{{issue.complaintno}}/{{issue.id}}/"></form>
    </td>
    <td class="update" style="display:none">
      <form method="GET" action="/complaint/update/{{issue.complaintno}}/{{issue.id}}/"></form>
    </td>
  </tr>
  {% endfor %}
</table>

<script type="text/javascript" src="/static/jquery/js/jquery.simplemodal-1.1.1.js"></script>
<script type="text/javascript" src="/static/jquery/js/jquery.contextMenu.js"></script>
<script type="text/javascript" src="/static/js/complainthandler.js"></script>

<ul id="updateMenu" class="contextMenu">
  <li><a href="#update">Update</a></li>
  <li><a href="#track">Track</a></li>
</ul>

<script type="text/javascript">
  $(document).ready (function() {
    showContextMenu (".updateMenu", "updateMenu");
  });
</script>
{% endblock %}
