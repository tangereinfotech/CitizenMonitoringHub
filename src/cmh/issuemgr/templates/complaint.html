{# Copyright 2011, Tangere Infotech Pvt Ltd [http://tangere.in]                 #}
{#                                                                              #}
{# Licensed under the Apache License, Version 2.0 (the "License");              #}
{# you may not use this file except in compliance with the License.             #}
{# You may obtain a copy of the License at                                      #}
{#                                                                              #}
{#       http://www.apache.org/licenses/LICENSE-2.0                             #}
{#                                                                              #}
{# Unless required by applicable law or agreed to in writing, software          #}
{# distributed under the License is distributed on an "AS IS" BASIS,            #}
{# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.     #}
{# See the License for the specific language governing permissions and          #}
{# limitations under the License.                                               #}

{% extends "signinbase.html" %}

{% block gmap_viewport_block%}
<meta name="viewport" content="initial-scale=0.1, user-scalable=no" />
{% endblock %}

{% block page_content %}
<div class="complaint_location">
  <form action="/complaint/submit/" method="post">
    {# {% csrf_token %} #}
    <div class="left_section">
      <div id="complaint_location"></div>
    </div>
    <div class="right_section">
      <fieldset>
        <legend>Location</legend>
        <select class="complaint_box" name="complaint_state" id="complaint_state">
          <option value="----">-- State --</option>
          {% for state in states %}
          <option value="{{state.optval}}">{{state.name}}</option>
          {% endfor %}
        </select><br/>
        <select class="complaint_box" name="complaint_distt" id="complaint_distt">
          <option value="----">-- District --</option>
        </select><br/>
        <select class="complaint_box" name="complaint_block" id="complaint_block">
          <option value="----">-- Block --</option>
        </select><br/>
        <select class="complaint_box" name="complaint_gp" id="complaint_gp">
          <option value="----">-- Gram Panchayat --</option>
        </select><br/>
        <select class="complaint_box" name="complaint_village" id="complaint_village">
          <option value="----">-- Village --</option>
        </select><br/>
      </fieldset>
      <fieldset>
        <legend>Complaint</legend>
        <label for="complaint_date" class="complaint_date">Date:</label>
        <br/>
        <input id="complaint_date" type="text" class="date_field" name="complaint_date" />
        <br/>
        <select class="complaint_box" name="complaint_department" id="complaint_department">
          <option value="----">-- Complaint Department --</option>
          {% for department in departments %}
          <option value="{{department.optval}}">{{department.name}}</option>
          {% endfor %}
        </select>
        <br/>
        <select class="complaint_box" name="complaint_summary" id="complaint_summary">
          <option value="----">-- Complaint Summary --</option>
        </select>
        <br/>
        <label for="complaint_description">Description:</label>
        <br/>
        <textarea name="complaint_description"
                  id="complaint_description"
                  class="complaint_description"
                  style="width:348px" rows="5"></textarea>
        <br/>
        {% for complaint_type in complaint_types %}
        <input type="checkbox" value="cbval_{{complaint_type.name}}" name="cbname_{{complaint_type.id}}_{{complaint_type.name}}"/>{{complaint_type.name}}<br/>
        {% endfor %}
      </fieldset>
    </div>
    <div style="float:left;clear:both;padding:10px 0px;width:100%">
      <fieldset>
        <legend> Complainant Details </legend>
        <label for="your_name">Name:</label>
        <input id="your_name" name="your_name" class="your_name" type="text" style="width:300px;" maxlength="100" />
        <label for="your_mobile" style="padding-left:40px;">Mobile Number:</label>
        <input id="your_mobile" name="your_mobile" class="your_mobile" type="text" style="width:300px;" maxlength="15" />
      </fieldset>
      <div style="text-align:center;width:100%;">
        <input type="submit" value="Submit Complaint" />
      </div>
    </div>
  </form>
</div>
<script type="text/javascript" src="/static/js/MapHandler.js"></script>
<script type="text/javascript" src="/static/js/DateTimeHandler.js"></script>
<script type="text/javascript" src="/static/js/complainthandler.js"></script>
<script type="text/javascript">
  (function($) { var field = null;})(django.jQuery);
  $ = django.jQuery;

  addEvent (window, 'load', (function () {MapHandler.init ('complaint_location')}));
  addEvent (window, 'load', (function () {DateTimeHandler.init ("date_field", "time_field")}));

  $("#complaint_state").change (populate_sub_select ("#complaint_state", "#complaint_distt", "District", "/complaint/select_children/"));

  $("#complaint_distt").change (populate_sub_select ("#complaint_distt", "#complaint_block", "Block", "/complaint/select_children/"));

  $("#complaint_block").change (populate_sub_select ("#complaint_block", "#complaint_gp", "Gram Panchayat", "/complaint/select_children/"));

  $("#complaint_gp").change (populate_sub_select ("#complaint_gp", "#complaint_village", "Village", "/complaint/select_children/"));

  $("#complaint_department").change (populate_sub_select ("#complaint_department", "#complaint_summary", "Complaint Summary", "/complaint/select_children/"));

  $("#complaint_summary").change (populate_default_complaint_description ("#complaint_summary", "#complaint_description", "/complaint/get_complaint_description/"));

</script>
{% endblock %}
