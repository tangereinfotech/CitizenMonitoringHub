{# Copyright 2011, Tangere Infotech Pvt Ltd [http://tangere.in]                 #}
{#                                                                              #}
{# Licensed under the Apache License, Version 2.0 (the "License");              #}
{# you may not use this file except in compliance with the License.             #}
{# You may obtain a copy of the License at                                      #}
{#                                                                              #}
{#       http://www.apache.org/licenses/LICENSE-2.0                             #}
{#                                                                              #}
{# Unless required by applicable law or agreed to in writing, software          #}
{# distributed under the License is distributed on an "AS IS" BASIS,            #}
{# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.     #}
{# See the License for the specific language governing permissions and          #}
{# limitations under the License.                                               #}

{% extends "basewithmenu.html" %}

{% block gmap_viewport_block%}
<meta name="viewport" content="initial-scale=0.1, user-scalable=no" />
{% endblock %}

{% block page_content %}
<div class="complaint_location">
  <form action="{{ post_url }}" method="post">
    {# {% csrf_token %} #}
    <div class="left_section">
      <div id="complaint_location"></div>
    </div>
    <div class="right_section">
      <fieldset>
        <legend>File Your Issue</legend>
        <div class="form-field">
          <label for="id_date" class="id_date">Date:</label>{{ form.logdate.errors }}
        </div>
        {{ form.logdate }}
        <br/>

        <div class="form-field">
          <label for="id_description">Description:</label>{{ form.description.errors }}
        </div>
        {{ form.description }}
        <br/>

        <div class="form-field">
          <label for="id_location">Location:</label>{{ form.locationdesc.errors }}
        </div>
        {{ form.locationid }}
        {{ form.locationdesc }}
        <div id="id_location_detail"></div>

        <div class="form-field">
          <label for="your_name">Your Name:</label>{{ form.yourname.errors }}
        </div>
        {{ form.yourname }}
        <br/>

        <div class="form-field">
          <label for="your_mobile">Your Mobile Number:</label>{{ form.yourmobile.errors }}
        </div>
        {{ form.yourmobile }}
        <br/>

        <div class="form-field">
          <label for="id_category">Categorize Your Complaint</label>{{ form.categoryid.errors }}
        </div>
        {{ form.categoryid }}
        {{ form.categorydesc }}
        <div id="id_category_detail" style="margin:0"></div>
        <div style="text-align:center;width:100%;">
          <input type="submit" value="Submit Complaint" />
        </div>
      </fieldset>
    </div>
  </form>
</div>
<script type="text/javascript" src="/static/js/MapHandler.js"></script>
<script type="text/javascript" src="/static/js/DateTimeHandler.js"></script>
<script type="text/javascript" src="/static/js/complainthandler.js"></script>
<script type="text/javascript">
  $(document).ready (function () {
    MapHandler.init ('complaint_location',
                     {{ map.center_lat }},
                     {{ map.center_long }},
                     {{map.zoom_level }});
    $("#id_logdate").datepicker ({dateFormat : 'dd/mm/yy'});
    field_autocomplete ("#id_locationdesc", "#id_locationid", "#id_location_detail", "/complaint/locations/");
    field_autocomplete ("#id_categorydesc", "#id_categoryid", "#id_category_detail", "/complaint/categories/");
  });
</script>
{% endblock %}
