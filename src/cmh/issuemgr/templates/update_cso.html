{# Copyright 2011, Tangere Infotech Pvt Ltd [http://tangere.in]                 #}
{#                                                                              #}
{# Licensed under the Apache License, Version 2.0 (the "License");              #}
{# you may not use this file except in compliance with the License.             #}
{# You may obtain a copy of the License at                                      #}
{#                                                                              #}
{#       http://www.apache.org/licenses/LICENSE-2.0                             #}
{#                                                                              #}
{# Unless required by applicable law or agreed to in writing, software          #}
{# distributed under the License is distributed on an "AS IS" BASIS,            #}
{# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.     #}
{# See the License for the specific language governing permissions and          #}
{# limitations under the License.                                               #}

{% extends "basewithmenu.html" %}

{% block page_content %}
<form action="." method="post">
  <table width="100%">
    <tr>
      <td> Complaint Number: </td>
      <td>
        <input id="id_complaintno"
               name="complaintno"
               value="{{ base.complaintno }}"
               readonly="readonly"
               style="width:100%">
      </td>
      <td style="width:25px"></td>
      <td> Current Status </td>
      <td>
        <input id="id_curstate"
               name="curstate"
               value="{{ current.curstate.get_value }}"
               readonly="readonly"
               style="width:100%">
      </td>
    </tr>
    <tr>
      <td> Filed By: </td>
      <td>
        <input id="id_filedby"
               name="filedby"
               value="{{ base.filedby.name }} &lt;{{ base.filedby.mobile }}&gt;"
               readonly="readonly"
               style="width:100%">
      </td>
      <td/>
      <td>Location: </td>
      <td>
        <input id="id_location"
               name="location"
               value="{{ base.get_location_name }}"
               readonly="readonly"
               style="width:100%">
      </td>
    </tr>
    <tr>
      <td> Filed On: </td>
      <td>
        <input id="id_created"
               name="created"
               value="{{ base.created|date:'f A, d/M/Y' }}"
               readonly="readonly"
               style="width:100%">
      </td>
      <td/>
      <td> Issue Date: </td>
      <td>
        <input id="id_loggedon"
               name="loggedon"
               value="{{ base.logdate|date:'d/M/Y' }}"
               readonly="readonly"
               style="width:100%">
      </td>
    </tr>
    <tr>
      <td> Assigned To: </td>
      <td>
        <input id="id_assignto"
               name="assignto"
               value="{{ current.get_official_name }}"
               readonly="readonly"
               style="width:100%">
      </td>
      <td/>
      <td> Department: </td>
      <td>
        <input id="id_department"
               name="department"
               value="{{ current.get_department_name }}"
               readonly="readonly"
               style="width:100%">
      </td>
    </tr>
    <tr>
      <td>Description:</td>
      <td colspan="4">
        <textarea name="description"
                  cols="40"
                  rows="6"
                  style="width:100%;"
                  id="id_description"
                  readonly="readonly">{{ base.description }}</textarea>
      </td>
    </tr>
    <tr>
      <td> New Status </td>
      <td>
        <select style="width:100%">
          {% for newstatus in newstatuses %}
          <option>{{ newstatus }}</option>
          {% endfor %}
        </select>
      </td>
    </tr>
    {% if current.curstate.get_value == 'New' %}
    <tr>
      <td> Location (Revised) </td>
      <td>
        <input id="id_revlocation"
               name="revlocation"
               style="width:100%">
      </td>
      <td/>
      <td> Department (Revised) </td>
      <td>
        <input id="id_revdepartment"
               name="revdepartment"
               style="width:100%">
      </td>
    </tr>
    {% endif %}
    <tr>
      <td>Comment:</td>
      <td colspan="4">
        <textarea name="comment"
                  cols="40"
                  rows="6"
                  style="width:100%;"
                  id="id_comment"></textarea>
      </td>
    </tr>
    <tr>
      <td/>
      <td style="text-align:right"> <input type="submit" value="Save" style="width:100px"> </td>
      <td/>
      <td style="text-align:left"> <input type="submit" value="Cancel" style="width:100px"> </td>
    </tr>
  </table>
</form>
<div class="complaint-history-banner">
  History for Complaint No. {{ base.complaintno }}
</div>
<table class="complaintlist">
  <tr>
    <th style="width:12%"> Changed On </th>
    <th style="width:12%"> Department </th>
    <th style="width:12%"> Status </th>
    <th style="width:40%"> Comment </th>
    <th style="width:24%"> Changed by </th>
  </tr>
  {% for complaint in complaints %}
  <tr>
    <td> {{ complaint.created|date:'f A, d/M/Y' }}</td>
    <td> {{ complaint.get_department_name }} </td>
    <td> {{ complaint.curstate.get_value }} </td>
    <td> {{ complaint.comment }} </td>
    <td> {{ complaint.creator.username }} </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
