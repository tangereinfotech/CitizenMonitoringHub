{% extends "basewithmenu.html" %}
{%load i18n%}
{%load my_issues_filter %}
{% block extra_heads %}
<link type="text/css" href="/static/jquery/css/jquery.contextMenu.css" rel="stylesheet" media="screen">
{% endblock %}
{% block page_content %}
   <style type="text/css" title="currentStyle">
            @import "/static/jquery-ui-1.9.2.custom/css/smoothness/jquery-ui-1.9.2.custom.css";
            .ui-button {
                padding: 8px;
            }
            #datatable_filter{
                display: None;
            }
    </style>
    
{% comment %}
    <script type="text/javascript">
        function replaceClass(elt, oldClass, newClass) {
            var oldRE = RegExp('\\b'+oldClass+'\\b');
            elt.className = elt.className.replace(oldRE, newClass);
        }
        function toggle(elt, on, off) {
            var onRE = RegExp('\\b'+on+'\\b');
            if (onRE.test(elt.className)) {
                elt.className = elt.className.replace(onRE, off);
            } else {
                replaceClass(elt, off, on);
            }
        }
    </script>
{% endcomment %}

    <script type="text/javascript" language="javascript" src="/static/jquery/js/jquery.js"></script>
    <script type="text/javascript" language="javascript" src="/static/jquery/js/jquery.dataTables.js"></script>
    <script type="text/javascript" language="javascript" src="/static/jquery/js/FixedColumns.js"></script>
    <script>
        var asInitVals = new Array();
        $(document).ready(function() {
                $('#datatable').dataTable({
                 "bFilter": true,
                 "bJQueryUI": true,
                 "sScrollX" : "600px",
                 "bSort": true,
                 "sPaginationType": "full_numbers",
                 "bProcessing" : true,
                 "sAjaxSource": "/reports/my_issues_data",
                 "bStateSave" : true,
                 "bServerSide": false,
                 "bAutoWidth" : true,
                 "aoColumns" : [
                 {% for col in cols %} {"sType": "{{col|col_type:cols}}", "sWidth": "{{col|col_width:cols}}","sName": "{{col|col_code:cols}}", "sClass" : "{{col|col_class:cols}}" ,"bVisible" : "{{col|is_col_visible:cols}}","bSearchable" : "{{col|is_col_searchable:cols}}","bSortable" : "{{col|is_col_sortable:cols}}"},
                 {% endfor %} 
                 ]
                });
           $(".colsearch").keyup( function () {
                    /* Filter on the column (the index) of this element */
	            var oTable = $('#datatable').dataTable();
                    oTable.fnFilter( this.value, $(".colsearch").index(this) );
            } );
	
	
	
            /*
             * Support functions to provide a little bit of 'user friendliness' to the textboxes in 
             * the footer
             */
            $(".colsearch").each( function (i) {
                    asInitVals[i] = this.value;
            } );
        } );
        function fnShowHide( iCol )
        {
	/* Get the DataTables object again - this is not a recreation, just a get of the object */
	var oTable = $('#datatable').dataTable();
	
	var bVis = oTable.fnSettings().aoColumns[iCol].bVisible;
	oTable.fnSetColumnVis( iCol, bVis ? false : true );
        }
    </script>
        <ul>
                {% for col in cols %} 
                <li> <a id={{dec}}_0 href="javascript:void(0);" onclick="fnShowHide({{col}});">{% trans "Toggle " %}{{col|col_name:cols}}<br></a></li> {% endfor %}
        </ul>
        <div id="all-issues-table-wrapper">
        <table id="datatable">
            <thead align="center">
                {% for col in cols %} <th>{{col|col_name:cols}}</th> {% endfor %} 
            </thead>
            <tbody>
            </tbody>
            <tfoot>
                {% for col in cols %} <td width="{{col|col_width:cols}}"><input  "class="colsearch" type="text"> </input></td> {% endfor %}
            </tfoot>
        </table>
        </div>
{% endblock %}
{% comment %}
{% block body_scripts %}
{% endblock %}
{% endcomment %}
