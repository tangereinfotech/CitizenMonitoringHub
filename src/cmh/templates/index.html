{# Copyright 2011, Tangere Infotech Pvt Ltd [http://tangere.in]                 #}
{#                                                                              #}
{# Licensed under the Apache License, Version 2.0 (the "License");              #}
{# you may not use this file except in compliance with the License.             #}
{# You may obtain a copy of the License at                                      #}
{#                                                                              #}
{#       http://www.apache.org/licenses/LICENSE-2.0                             #}
{#                                                                              #}
{# Unless required by applicable law or agreed to in writing, software          #}
{# distributed under the License is distributed on an "AS IS" BASIS,            #}
{# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.     #}
{# See the License for the specific language governing permissions and          #}
{# limitations under the License.                                               #}

{% extends "signinbase.html" %}
{% block extra_heads %}
    <meta name="viewport" content="initial-scale=0.1, user-scalable=no" />
{% endblock %}

{% block page_content %}
<div id="base_map"></div>
<div id="trending-issues-section">
  <div class="section-title">Hot Issues</div>
  <ul class="period-right">
    <li>Last:</li>
    <li><a href="javascript:update_issues_trend (1);">Week</a></li>
    <li><a href="javascript:update_issues_trend (2);">Month</a></li>
    <li><a href="javascript:update_issues_trend (3);">3 Months</a></li>
  </ul>
  <div id="trending-issues-chart"></div>
</div>
<div class="resolution-metrics">Complaint Resolution Metrics</div>
<div id="trending-open-section">
  <div class="section-title">Opening Trend</div>
  <ul class="period-left">
    <li>Last:</li>
    <li><a href="/complaint/trend-open/week/">Week</a></li>
    <li><a href="/complaint/trend-open/month/">Month</a></li>
    <li><a href="/complaint/trend-open/year/">Year</a></li>
  </ul>
  <div id="trending-open-chart"></div>
</div>
<div id="trending-resolution-section">
  <div class="section-title">Resolution Trend</div>
  <ul class="period-right">
    <li>Last:</li>
    <li><a href="/complaint/trend-resolve/week/">Week</a></li>
    <li><a href="/complaint/trend-resolve/month/">Month</a></li>
    <li><a href="/complaint/trend-resolve/year/">Year</a></li>
  </ul>
  <div id="trending-resolution-chart"></div>
</div>
<script type="text/javascript" src="/static/jquery/js/jqplot.dateAxisRenderer.js"></script>
<script type="text/javascript" src="/static/jquery/js/jqplot.pointLabels.min.js"></script>
<script type="text/javascript" src="/static/js/MapHandler.js"></script>
<script type="text/javascript" src="/static/js/complainthandler.js"></script>
<script type="text/javascript">
  $(document).ready (function () {
    MapHandler.init ('base_map',
                     {{ map.center_lat }},
                     {{ map.center_long }},
                     {{ map.zoom_level }},
                     function () {
                       MapHandler.update_with_stats ('/complaint/get_category_map_update/');
                     });
    update_issues_trend (1);
    $.jqplot ("trending-open-chart",
              [[[1, 20],[3,5.12],[5,13.1],[7,33.6],[9,85.9],[11,219.9]],
               [[1, 30],[3,15.12],[5,23.1],[7,43.6],[9,95.9],[11,229.9]]],
              { axes: {yaxis : {min : 0, max: 240}},
                series: [{color: '#5fab78'}, {color : 'red'}]});
    $.jqplot ("trending-resolution-chart",
              [[[1, 20],[3,5.12],[5,13.1],[7,33.6],[9,85.9],[11,219.9]]],
              { axes: {yaxis : {min : 0, max: 240}},
                series: [{color: '#5fab78'}]});
  });
  function update_issues_trend (period) {
    show_hot_complaints ("trending-issues-chart", "/complaint/hot_complaints/", period);
  }
</script>
{% endblock %}
